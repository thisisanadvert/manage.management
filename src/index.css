@import './styles/accessibility.css';
@import './styles/tooltips-optimized.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========================================
   TOOLTIP STYLES MOVED TO SEPARATE FILE
   See: src/styles/tooltips-optimized.css
   ======================================== */

/* TEMPORARILY DISABLED - MODAL CSS CAUSING CONFLICTS */
/*
#portal-root {
  position: relative;
  z-index: auto;
}

[role="dialog"] {
  z-index: 10000 !important;
  pointer-events: auto !important;
}

[role="dialog"] * {
  pointer-events: auto !important;
}

.fixed.inset-0.bg-black.bg-opacity-50 {
  pointer-events: auto !important;
  background-color: transparent !important;
}

body.modal-open {
  overflow: hidden;
}

[role="dialog"],
.modal-container {
  pointer-events: auto !important;
  z-index: 10000 !important;
}

.modal-backdrop,
[data-modal-backdrop],
.fixed.inset-0.bg-black.bg-opacity-50 {
  pointer-events: auto !important;
  background-color: transparent !important;
}

#portal-root .fixed.inset-0 {
  pointer-events: auto !important;
}

#portal-root [role="dialog"] {
  pointer-events: auto !important;
}

[aria-labelledby="modal-title"] {
  pointer-events: auto !important;
  z-index: 100000 !important;
  position: relative !important;
}

[aria-labelledby="modal-title"] * {
  pointer-events: auto !important;
}
*/

/* Tooltip Positioning & Z-Index Management */
.absolute.bottom-full,
.absolute.top-full,
.absolute.left-full,
.absolute.right-full,
div[class*="absolute"][class*="bottom-full"],
div[class*="absolute"][class*="top-full"],
div[class*="absolute"][class*="left-full"],
div[class*="absolute"][class*="right-full"] {
  z-index: 1100 !important;
}

/* Tooltip Triggers */
button[aria-label*="guidance"],
button[aria-label*="tooltip"],
button[aria-label*="help"],
button[aria-label*="information"] {
  pointer-events: auto !important;
  z-index: 999 !important;
  position: relative !important;
}

/* Critical Color Overrides */
.text-red-600 {
  color: rgb(220, 38, 38) !important;
}

/* Force visibility for any hidden tooltips */
.absolute[style*="display: none"] {
  display: block !important;
}

/* Ensure tooltip triggers are clickable */
button[aria-label*="guidance"],
button[aria-label*="tooltip"],
button[aria-label*="help"] {
  pointer-events: auto !important;
  z-index: 999 !important;
}

/* UNIVERSAL TOOLTIP FRAMEWORK - PLATFORM-WIDE COVERAGE */
/* This section ensures ALL tooltips work across the entire platform */

/* 1. Universal Tooltip Container Fixes */
[role="tooltip"],
.tooltip-content,
.legal-guidance-tooltip,
div[class*="tooltip"],
div[class*="popover"] {
  z-index: 1100 !important;
  position: relative !important;
  isolation: isolate !important;
  backdrop-filter: blur(8px) !important;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04), 0 0 0 1px rgba(0, 0, 0, 0.05) !important;
  border-radius: 8px !important;
}

/* 2. Tooltip Isolation and Containment */
.tooltip-content,
.legal-guidance-tooltip {
  contain: layout style paint !important;
  transform: translateZ(0) !important;
  will-change: transform !important;
}

/* 3. Dark Tooltips (like standard Tooltip component) */
.tooltip-content,
[role="tooltip"]:not(.legal-guidance-tooltip) {
  background-color: rgb(17 24 39) !important; /* gray-900 */
  color: rgb(255 255 255) !important; /* white */
  border: 2px solid rgb(75 85 99) !important; /* gray-600 border */
}

/* 4. Light Tooltips (like legal guidance tooltips) */
.legal-guidance-tooltip {
  background-color: rgb(255 255 255) !important; /* white */
  color: rgb(17 24 39) !important; /* gray-900 */
  border: 2px solid rgb(59 130 246) !important; /* blue-500 border */
}

/* 3. Universal Positioning Fixes */
.absolute.bottom-full,
.absolute.top-full,
.absolute.left-full,
.absolute.right-full,
div[class*="absolute"][class*="bottom-full"],
div[class*="absolute"][class*="top-full"],
div[class*="absolute"][class*="left-full"],
div[class*="absolute"][class*="right-full"] {
  z-index: 1001 !important;
}

/* 3a. Specific Legal Guidance Tooltip Fixes */
.legal-guidance-tooltip {
  z-index: 1001 !important;
  background-color: rgb(255 255 255) !important;
  color: rgb(17 24 39) !important;
  border: 1px solid rgb(229 231 235) !important;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* 3b. Tooltip Backdrop Fixes - Only target tooltip backdrops, not modal backdrops */
div[class*="fixed"][class*="inset-0"][class*="tooltip"] {
  z-index: 999 !important;
}

/* 4. Tooltip Content Visibility */
.absolute.bottom-full > div,
.absolute.top-full > div,
.absolute.left-full > div,
.absolute.right-full > div,
div[class*="absolute"][class*="bottom-full"] > div,
div[class*="absolute"][class*="top-full"] > div,
div[class*="absolute"][class*="left-full"] > div,
div[class*="absolute"][class*="right-full"] > div {
  background-color: inherit !important;
  color: inherit !important;
  border: inherit !important;
  box-shadow: inherit !important;
  z-index: 1000 !important;
}

/* 5. Tooltip Arrows */
.tooltip-arrow,
div[class*="absolute"] div[class*="rotate-45"],
.absolute div.rotate-45 {
  background-color: inherit !important;
  z-index: 999 !important;
}

/* 6. Mandatory Indicators (Red Circles with Asterisks) */
.text-red-600,
span[class*="text-red"],
button[class*="text-red"] {
  color: rgb(220 38 38) !important; /* red-600 */
}

/* 7. Tooltip Triggers */
button[aria-label*="guidance"],
button[aria-label*="tooltip"],
button[aria-label*="help"],
button[aria-label*="information"],
.tooltip-trigger,
[data-tooltip] {
  pointer-events: auto !important;
  z-index: 999 !important;
  position: relative !important;
}

/* 8. Backdrop Fixes - Only target specific tooltip backdrops, not modal backdrops */
.fixed.inset-0.z-40:not([role="dialog"]):not(.modal-backdrop),
.tooltip-backdrop {
  background-color: transparent !important;
  pointer-events: none !important;
}

/* 9. Platform-Specific Component Fixes */
/* Dashboard tooltips */
.dashboard-tooltip,
.stats-tooltip,
.widget-tooltip {
  z-index: 1000 !important;
  background-color: rgb(255 255 255) !important;
  color: rgb(17 24 39) !important;
  border: 1px solid rgb(229 231 235) !important;
}

/* Form tooltips */
.form-tooltip,
.field-tooltip,
.input-tooltip {
  z-index: 1000 !important;
  background-color: rgb(17 24 39) !important;
  color: rgb(255 255 255) !important;
}

/* Settings page tooltips */
.settings-tooltip,
.preference-tooltip {
  z-index: 1000 !important;
  background-color: rgb(255 255 255) !important;
  color: rgb(17 24 39) !important;
  border: 1px solid rgb(229 231 235) !important;
}

/* ADDITIONAL PLATFORM-WIDE TOOLTIP FIXES */
/* Ensure tooltips work in all possible scenarios */

/* 10. Override any potential CSS conflicts */
* [role="tooltip"],
* .tooltip-content,
* .legal-guidance-tooltip {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  pointer-events: auto !important;
  z-index: 1001 !important;
}

/* 11. Fix tooltips in modals and overlays */
.modal [role="tooltip"],
.modal .tooltip-content,
.modal .legal-guidance-tooltip,
.overlay [role="tooltip"],
.overlay .tooltip-content,
.overlay .legal-guidance-tooltip {
  z-index: 1100 !important;
}

/* 12. Critical Z-Index Hierarchy for Tooltips */
/* Ensure tooltips always appear above all other content */
.z-\\[1001\\] {
  z-index: 1001 !important;
}

.z-\\[999\\] {
  z-index: 999 !important;
}

/* 13. Specific Component Layer Fixes */
/* Cards and containers should not interfere with tooltips */
.card,
.bg-white,
.bg-gray-50,
.bg-blue-50,
.bg-purple-50,
.bg-amber-50,
.bg-green-50 {
  position: relative;
  z-index: auto !important;
}

/* 14. Tooltip Container Positioning */
div[class*="absolute"][class*="z-[1001]"] {
  z-index: 1001 !important;
  position: absolute !important;
}

/* 15. Force tooltip visibility over all content */
.legal-guidance-tooltip,
[role="tooltip"] {
  z-index: 1001 !important;
  position: relative !important;
  background: white !important;
  border: 1px solid #e5e7eb !important;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04) !important;
}

/* 12. Fix tooltips in cards and containers */
.card [role="tooltip"],
.card .tooltip-content,
.card .legal-guidance-tooltip {
  z-index: 1000 !important;
  position: relative !important;
}

/* 13. Ensure tooltip content is never hidden */
[role="tooltip"] *,
.tooltip-content *,
.legal-guidance-tooltip * {
  color: inherit !important;
  background-color: transparent !important;
}

/* 14. Fix tooltip positioning in flex containers */
.flex [role="tooltip"],
.flex .tooltip-content,
.flex .legal-guidance-tooltip {
  position: absolute !important;
  z-index: 1000 !important;
}

/* 15. Override Tailwind utilities that might hide tooltips */
.hidden [role="tooltip"],
.invisible [role="tooltip"] {
  display: block !important;
  visibility: visible !important;
}

/* 16. Ensure tooltips work with transforms */
.transform [role="tooltip"],
.transform .tooltip-content,
.transform .legal-guidance-tooltip {
  transform: none !important;
  z-index: 1000 !important;
}

/* 17. Fix tooltips in grid layouts */
.grid [role="tooltip"],
.grid .tooltip-content,
.grid .legal-guidance-tooltip {
  position: absolute !important;
  z-index: 1000 !important;
}

/* 18. Ensure tooltips work in all viewport sizes */
@media (max-width: 768px) {
  [role="tooltip"],
  .tooltip-content,
  .legal-guidance-tooltip {
    max-width: 90vw !important;
    z-index: 1000 !important;
  }
}

/* 19. Fix tooltips in print mode */
@media print {
  [role="tooltip"],
  .tooltip-content,
  .legal-guidance-tooltip {
    display: none !important;
  }
}

/* 20. COMPREHENSIVE Z-INDEX HIERARCHY ENFORCEMENT */
/* This section ensures proper layering across the entire platform */

/* 20a. Override any remaining z-50, z-40, z-30 classes that might interfere */
.z-50 {
  z-index: 1000 !important;
}

.z-40 {
  z-index: 1050 !important;
}

.z-30 {
  z-index: 1030 !important;
}

/* 20b. Ensure tooltips always win the z-index battle */
[role="tooltip"],
.tooltip-content,
.legal-guidance-tooltip {
  z-index: 1001 !important;
  position: relative !important;
}

/* 20c. Force tooltip visibility in all scenarios */
div[class*="z-[1001]"],
div[class*="z-[1000]"] {
  z-index: 1001 !important;
}

/* 20d. Tooltip close buttons should be clickable */
button[aria-label="Close tooltip"],
button[aria-label*="close"] {
  z-index: 1002 !important;
  position: relative !important;
  pointer-events: auto !important;
}

/* 20e. Final override for any stubborn tooltips */
.legal-guidance-tooltip button,
[role="tooltip"] button {
  z-index: 1002 !important;
  pointer-events: auto !important;
}

/* MODAL OVERLAY ELIMINATION - COMPREHENSIVE OVERRIDE */
/* This section ensures NO modal overlays can appear, regardless of source */

/* Override any bg-background classes (including Tailwind arbitrary values) */
.bg-background,
.bg-background\/80,
.bg-background\/50,
.bg-background\/60,
.bg-background\/70,
.bg-background\/90,
[class*="bg-background/"],
[class*="bg-background\\"] {
  background-color: transparent !important;
}

/* Override any backdrop blur effects on modal overlays */
.fixed.inset-0.backdrop-blur-sm,
.fixed.inset-0.backdrop-blur,
.fixed.inset-0.backdrop-blur-md,
.fixed.inset-0.backdrop-blur-lg,
[class*="backdrop-blur"] {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Comprehensive modal overlay elimination - target any fixed overlay */
.fixed.inset-0.z-50,
.fixed.inset-0.z-40,
.fixed.inset-0.z-30,
.fixed.inset-0[class*="z-"],
div[class*="fixed"][class*="inset-0"][class*="z-"] {
  background-color: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  /* CRITICAL FIX: Remove pointer events to prevent click blocking */
  pointer-events: none !important;
}

/* Specific override for the exact classes mentioned in the issue */
.fixed.inset-0.z-50.bg-background\/80.backdrop-blur-sm {
  background-color: transparent !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  /* CRITICAL FIX: Remove pointer events to prevent click blocking */
  pointer-events: none !important;
}

/* Hide number input spinners across all browsers */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type="number"] {
  -moz-appearance: textfield;
  appearance: textfield;
}

@font-face {
  font-family: 'PixelFont';
  src: url('https://fonts.cdnfonts.com/css/press-start-2p') format('woff2');
  font-weight: normal;
  font-style: normal;
}

.pixel-font {
  font-family: 'Press Start 2P', system-ui;
  letter-spacing: -1px;
}

@keyframes pulse-border {
  0% {
    border-color: rgba(34, 197, 94, 0.2);
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.2);
  }
  50% {
    border-color: rgba(34, 197, 94, 0.6);
    box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2);
  }
  100% {
    border-color: rgba(34, 197, 94, 0.2);
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.2);
  }
}

.animate-border-pulse {
  animation: pulse-border 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}